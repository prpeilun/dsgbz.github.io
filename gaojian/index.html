<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport" />
	<title>佩伦导航-稿件整理</title>
	<meta name="description" content="佩伦导航是各类网站的集合，依据类型进行导航。便于各类用户快速找到自己想要的网站。本站具有较高的实用性，无任何类型的广告，简洁易用。致力于成为您的浏览器主页。">
	<meta name="keywords" content="导航页,佩伦导航,导航,网址导航">
	<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="reset.css">
	<style type="text/css">
		#csvFileInput{
		    position: absolute;
		    right: 0px;
		    opacity: 0;
		}
	</style> 
  </head>
  <body id="bo">
  	<script type="text/javascript">
  		function essay(name, contect, niming, type, title, article) {
			this.name = name;
			this.contect = contect;
			this.niming = niming;
			this.type = type;
			this.title = title;
			this.article = article;
		}
  	</script>
  	<div class="bgimg" style="background-image: url(&quot;http://api.btstu.cn/sjbz/?lx=dongman&amp;k=8197557733577572&quot;);"></div>
	<div class="navbar">
		<header>
			<h1 class="title"><a href="https://mp.weixin.qq.com/s/FIQXB75zQJLThpQM9ZVk8A" class="nuxt-link-exact-active nuxt-link-active title  transparent">缔声广播站 - 稿件整理</a></h1>
			<a class="subtitle  transparent" onclick="location.reload();">
				<span id="text">&nbsp;何其所幸 执此一声</span>
			</a>
		</header>
	<div class="con transparent">
		<div class="title">
			<img src="../img/稿件库.png" alt="稿件"><span><input type="file" id="csvFileInput" onchange="readCSVFile(this)"/>导入稿件</span>
		</div>
		<div class="select fullwidth">
			<div class="btn start">
				普通导出
			</div>
			<div class="btn nbstart">
				管理员导出
			</div>
		</div>
	</div>
	</div>
	<div class="con transparent">
		<div class="title">
			<img src="../img/歌单2.png" alt="歌单2"><span>导出结果</span>
		</div>
		<div id="gaojian">

		</div>
	</div>


	<script>
		var allData;
	    function csvToObject(csvString){
	        var csvarry = csvString.split("\r\n");
	        var datas = [];
	        var headers = csvarry[0].split(",");
	        for(var i = 1;i < csvarry.length - 1;i++){
	            var data = {};
	            var temp = csvarry[i].split(",");
	                 for(var j = 0;j < temp.length;j++){
	                     data[headers[j]] = temp[j].replace(/\"/g, "");
	                 }
	            datas.push(data);
	        }
	         return datas;
	    }

	     function FuncCSVInport() {
	         $("#csvFileInput").val("");
	         $("#csvFileInput").click();
	     }

	     function readCSVFile(obj) {
	         var reader = new FileReader();
	         reader.readAsText(obj.files[0]);
	         reader.onload = function () {
	               data = csvToObject(this.result)
	               allData = data
	               console.log(data);
	        }
	   }
	</script>
    <script type="text/javascript">

		function ap (s) { 
			$("#gaojian").html($("#gaojian").html() + s)
		}

		$(".start").click(function() {
    		var essays = new Array();

			for (var i = 0; i < allData.length; i++) {
				essays.push(new essay(allData[i]["\"1.姓名\""], allData[i]["\"2.常用联系方式（方便改稿）\""], allData[i]["\"3.是否匿名\""], allData[i]["\"4.投稿类型\""], allData[i]["\"5.稿件题目\""], allData[i]["\"6.稿件正文\""]));
			}
			console.log(essays)
	        
	        for (var i = 0; i < essays.length; i++) {
	        	//ap("<span class='line'></span>")
	        	ap("</br>")
	        	if(essays[i].niming == "A.匿名")
	        		essays[i].name = "匿名"
	        	if(essays[i].article != "")
	        		//ap("<blockquote>" + essays[i].article  + essays[i].name + " " + essays[i].type.split(".")[1]  + "</blockquote>")
	        		ap("<section style=\"margin: 5px 8.26562px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;text-align: center;\"><section data-width=\"100%\" style=\"padding: 25px 20px 25px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word; vertical-align: top; background-image: url(&quot;https://mmbiz.qlogo.cn/mmbiz_png/Avpd0CPibXBpGmLls8dPD9ibib5MdcdCunDRpbUynM2H0kRQ7fyTJYHrK69DMuUuCsNXRONEB3ateDz7KTlZ3Rf3g/0?wx_fmt=gif&quot;); background-position: 0% 0%; background-repeat: repeat; background-size: 9.4512%; background-attachment: scroll; border-width: 6px 0px 0px; box-shadow: rgb(66, 66, 66) 1.41421px 1.41421px 8px; border-radius: 5px; border-style: solid none none; border-color: rgb(127, 201, 212) rgb(62, 62, 62) rgb(62, 62, 62); overflow: hidden;\"><section style=\"max-width: 100%; box-sizing: border-box; overflow-wrap: break-word;\"><section style=\"max-width: 100%; box-sizing: border-box; overflow-wrap: break-word; text-align: justify; font-size: 14px; color: rgb(117, 117, 117);\"><h2 class='etitle'>" + essays[i].title + "</h2><p class='sb'>" + essays[i].article + "</p></br></br><p>" +  essays[i].name + " "+ essays[i].type.split(".")[1]+ "</p></section></section></section></section>")
	        		ap("  ")
	        }
		})


		$(".nbstart").click(function() {
    		var essays = new Array();

			for (var i = 0; i < allData.length; i++) {
				essays.push(new essay(allData[i]["\"1.姓名\""], allData[i]["\"2.常用联系方式（方便改稿）\""], allData[i]["\"3.是否匿名\""], allData[i]["\"4.投稿类型\""], allData[i]["\"5.稿件题目\""], allData[i]["\"6.稿件正文\""]));
			}
			console.log(essays)
	        
	        for (var i = 0; i < essays.length; i++) {
	        	//ap("<span class='line'></span>")
	        	ap("</br>")
	        	if(essays[i].article != "")
	        		//ap("<blockquote>" + essays[i].article  + essays[i].name + " " + essays[i].type.split(".")[1]  + "</blockquote>")
	        		ap("<section style=\"margin: 5px 8.26562px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;text-align: center;\"><section data-width=\"100%\" style=\"padding: 25px 20px 25px; max-width: 100%; box-sizing: border-box; overflow-wrap: break-word; vertical-align: top; background-image: url(&quot;https://mmbiz.qlogo.cn/mmbiz_png/Avpd0CPibXBpGmLls8dPD9ibib5MdcdCunDRpbUynM2H0kRQ7fyTJYHrK69DMuUuCsNXRONEB3ateDz7KTlZ3Rf3g/0?wx_fmt=gif&quot;); background-position: 0% 0%; background-repeat: repeat; background-size: 9.4512%; background-attachment: scroll; border-width: 6px 0px 0px; box-shadow: rgb(66, 66, 66) 1.41421px 1.41421px 8px; border-radius: 5px; border-style: solid none none; border-color: rgb(127, 201, 212) rgb(62, 62, 62) rgb(62, 62, 62); overflow: hidden;\"><section style=\"max-width: 100%; box-sizing: border-box; overflow-wrap: break-word;\"><section style=\"max-width: 100%; box-sizing: border-box; overflow-wrap: break-word; text-align: justify; font-size: 14px; color: rgb(117, 117, 117);\"><h2 class='etitle'>" + essays[i].title + "</h2><p class='sb'>" + essays[i].article + "</p></br></br><p>" +  essays[i].name+ "(" + essays[i].niming + ") "+ essays[i].type.split(".")[1]+ " &nbsp;联系方式：" + essays[i].contect + "</p></section></section></section></section>")
	        		ap("  ")
	        }
		})
    </script>
</body>
</html>